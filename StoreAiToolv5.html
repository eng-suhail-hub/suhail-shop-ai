<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suhail v8 | AI Image Ingestion Pro</title>
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="./style.css">
</head>
<body>

<div class="notif-container" id="notifContainer"></div>
<button class="menu-toggle" onclick="toggleSidebar()"><i class="fas fa-sliders-h"></i></button>
<div class="overlay-bg" onclick="toggleSidebar()"></div>

<!-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
     SIDEBAR
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ -->
<aside class="sidebar" id="sidebar">
  <div class="sb-head">
    <div class="sb-logo">
      <div class="sb-logo-icon"><i class="fas fa-wand-magic-sparkles"></i></div>
      <div class="sb-logo-text">
        <h1>Famelo v8</h1>
        <p>AI Image Ingestion Pro</p>
      </div>
    </div>
  </div>

  <div class="sb-body">

    <!-- AI PROVIDER -->
    <div class="sec-label"><i class="fas fa-robot"></i> ูุฒูุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู</div>

    <div class="provider-select-wrap" id="providerGrid">
      <button class="prov-btn active" data-prov="pollinations" onclick="selectProvider('pollinations')">
        <span class="pb-icon">๐ธ</span>
        <span class="pb-name">Pollinations</span>
        <span class="pb-badge free-b">ูุฌุงูู</span>
      </button>
      <button class="prov-btn" data-prov="openrouter" onclick="selectProvider('openrouter')">
        <span class="pb-icon">๐</span>
        <span class="pb-name">OpenRouter</span>
        <span class="pb-badge free-b">ูุฌุงูู</span>
      </button>
      <button class="prov-btn" data-prov="groq" onclick="selectProvider('groq')">
        <span class="pb-icon">โก</span>
        <span class="pb-name">Groq</span>
        <span class="pb-badge free-b">ูุฌุงูู</span>
      </button>
      <button class="prov-btn" data-prov="gemini" onclick="selectProvider('gemini')">
        <span class="pb-icon">โจ</span>
        <span class="pb-name">Gemini</span>
        <span class="pb-badge paid-b">ูุฏููุน</span>
      </button>
      <button class="prov-btn" data-prov="huggingface" onclick="selectProvider('huggingface')">
        <span class="pb-icon">๐ค</span>
        <span class="pb-name">HuggingFace</span>
        <span class="pb-badge free-b">ูุฌุงูู</span>
      </button>
      <button class="prov-btn" data-prov="together" onclick="selectProvider('together')">
        <span class="pb-icon">๐ค</span>
        <span class="pb-name">Together</span>
        <span class="pb-badge paid-b">ูุฏููุน</span>
      </button>
    </div>

    <!-- POLLINATIONS -->
    <div class="prov-panel active" id="panel_pollinations">
      <div class="field">
        <label>ุงููููุฐุฌ <span style="color:var(--green);font-size:.6rem;">(ุจุฏูู ููุชุงุญ API โ ูุฌุงูู ุชูุงูุงู)</span></label>
        <select id="cfg_pol_model" onchange="saveConfig()">
          <option value="openai">OpenAI GPT-4o Vision (ุงูุฃููู)</option>
          <option value="openai-large">OpenAI Large (ุฏููู ุฌุฏุงู)</option>
          <option value="mistral">Mistral (ุณุฑูุน)</option>
          <option value="qwen-coder">Qwen Coder (ููููุฏ)</option>
        </select>
        <small>โ Pollinations.AI ูุฌุงูู 100% โ ูุง ูุชุทูุจ ุญุณุงุจุงู ุฃู ููุชุงุญุงู</small>
      </div>
      <div class="field">
        <label>Pollinations seed (ุงุฎุชูุงุฑู โ ููุชุดุบูู ุงูุซุงุจุช)</label>
        <input type="number" id="cfg_pol_seed" placeholder="ูุซุงู: 42" onchange="saveConfig()">
      </div>
    </div>

    <!-- OPENROUTER -->
    <div class="prov-panel" id="panel_openrouter">
      <div class="field">
        <label>ููุชุงุญ API ูู OpenRouter <span style="color:var(--green);font-size:.6rem;">(ุงุฎุชูุงุฑู โ ููุงุฐุฌ ูุฌุงููุฉ)</span></label>
        <div class="key-wrap" id="kw_openrouter">
          <input type="password" id="cfg_or_key" placeholder="sk-or-..." oninput="saveKey('openrouter','cfg_or_key')">
          <button class="key-eye" onclick="toggleEye('cfg_or_key',this)"><i class="fas fa-eye"></i></button>
          <div class="key-saved"></div>
        </div>
        <small>ุงุญุตู ุนููู ูู <a href="https://openrouter.ai/keys" target="_blank">openrouter.ai</a> โ ูุซูุฑ ูู ุงูููุงุฐุฌ ูุฌุงููุฉ ุจุฏูู ููุชุงุญ</small>
      </div>
      <div class="field">
        <label>ุงููููุฐุฌ</label>
        <select id="cfg_or_model" onchange="saveConfig()">
          <option value="meta-llama/llama-3.2-11b-vision-instruct:free">Llama 3.2 11B Vision (ูุฌุงูู โ)</option>
          <option value="meta-llama/llama-3.2-90b-vision-instruct:free">Llama 3.2 90B Vision (ูุฌุงูู โ)</option>
          <option value="google/gemini-2.0-flash-exp:free">Gemini 2.0 Flash Exp (ูุฌุงูู โ)</option>
          <option value="qwen/qwen2-vl-72b-instruct:free">Qwen2-VL 72B (ูุฌุงูู โ)</option>
          <option value="anthropic/claude-3.5-sonnet">Claude 3.5 Sonnet (ูุฏููุน)</option>
        </select>
      </div>
    </div>

    <!-- GROQ -->
    <div class="prov-panel" id="panel_groq">
      <div class="field">
        <label>ููุชุงุญ Groq API</label>
        <div class="key-wrap" id="kw_groq">
          <input type="password" id="cfg_groq_key" placeholder="gsk_..." oninput="saveKey('groq','cfg_groq_key')">
          <button class="key-eye" onclick="toggleEye('cfg_groq_key',this)"><i class="fas fa-eye"></i></button>
          <div class="key-saved"></div>
        </div>
        <small>ูู <a href="https://console.groq.com/keys" target="_blank">console.groq.com</a> โ ูุฌุงูู: 30 ุทูุจ/ุฏูููุฉ</small>
      </div>
      <div class="field">
        <label>ุงููููุฐุฌ</label>
        <select id="cfg_groq_model" onchange="saveConfig()">
          <option value="llama-3.2-90b-vision-preview">Llama 3.2 90B Vision (ุงูุฃูุถู)</option>
          <option value="llama-3.2-11b-vision-preview">Llama 3.2 11B Vision (ุฃุณุฑุน)</option>
        </select>
      </div>
    </div>

    <!-- GEMINI -->
    <div class="prov-panel" id="panel_gemini">
      <div class="field">
        <label>ููุชุงุญ Gemini API</label>
        <div class="key-wrap" id="kw_gemini">
          <input type="password" id="cfg_gem_key" placeholder="AIzaSy..." oninput="saveKey('gemini','cfg_gem_key')">
          <button class="key-eye" onclick="toggleEye('cfg_gem_key',this)"><i class="fas fa-eye"></i></button>
          <div class="key-saved"></div>
        </div>
        <small>ูู <a href="https://aistudio.google.com" target="_blank">aistudio.google.com</a></small>
      </div>
      <div class="field">
        <label>ุงููููุฐุฌ</label>
        <select id="cfg_gem_model" onchange="saveConfig()">
          <option value="gemini-2.5-flash">Gemini 2.5 Flash (ุงูุฃุญุฏุซ)</option>
          <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite(ุณุฑูุน)</option>
          <option value="gemini-1.5-pro">Gemini 1.5 Pro (ุฏููู)</option>
        </select>
      </div>
    </div>

    <!-- HUGGINGFACE -->
    <div class="prov-panel" id="panel_huggingface">
      <div class="field">
        <label>ููุชุงุญ HuggingFace API</label>
        <div class="key-wrap" id="kw_huggingface">
          <input type="password" id="cfg_hf_key" placeholder="hf_..." oninput="saveKey('huggingface','cfg_hf_key')">
          <button class="key-eye" onclick="toggleEye('cfg_hf_key',this)"><i class="fas fa-eye"></i></button>
          <div class="key-saved"></div>
        </div>
        <small>ูู <a href="https://huggingface.co/settings/tokens" target="_blank">huggingface.co</a> โ ุทุจูุฉ ูุฌุงููุฉ</small>
      </div>
      <div class="field">
        <label>ุงููููุฐุฌ</label>
        <select id="cfg_hf_model" onchange="saveConfig()">
          <option value="Qwen/Qwen2-VL-7B-Instruct">Qwen2-VL 7B (ููุตู ุจู)</option>
          <option value="microsoft/Phi-3.5-vision-instruct">Phi-3.5 Vision</option>
        </select>
      </div>
    </div>

    <!-- TOGETHER -->
    <div class="prov-panel" id="panel_together">
      <div class="field">
        <label>ููุชุงุญ Together AI API</label>
        <div class="key-wrap" id="kw_together">
          <input type="password" id="cfg_tog_key" placeholder="ุฑูุฒ Together AI..." oninput="saveKey('together','cfg_tog_key')">
          <button class="key-eye" onclick="toggleEye('cfg_tog_key',this)"><i class="fas fa-eye"></i></button>
          <div class="key-saved"></div>
        </div>
        <small>ูู <a href="https://together.ai" target="_blank">together.ai</a></small>
      </div>
      <div class="field">
        <label>ุงููููุฐุฌ</label>
        <select id="cfg_tog_model" onchange="saveConfig()">
          <option value="meta-llama/Llama-3.2-11B-Vision-Instruct-Turbo">Llama 3.2 Vision 11B</option>
          <option value="meta-llama/Llama-3.2-90B-Vision-Instruct-Turbo">Llama 3.2 Vision 90B (ุฃูุถู)</option>
        </select>
      </div>
    </div>

    <!-- LANGUAGE & PROMPT -->
    <div class="sec-label"><i class="fas fa-language"></i> ุงููุบุฉ ูุงูู Prompt</div>
    <div class="field">
      <label>ูุบุฉ ุงููุชุงุฆุฌ</label>
      <select id="cfg_lang" onchange="saveConfig()">
        <option value="ar">ุงูุนุฑุจูุฉ</option>
        <option value="en">English</option>
        <option value="both">ููุงููุง (AR + EN)</option>
      </select>
    </div>
    <div class="field">
      <label>ุงูุชุนูููุงุช ุงูุฃุณุงุณูุฉ</label>
      <textarea id="cfg_prompt" rows="3" onchange="saveConfig()">ุญูู ุงูุตูุฑุฉ ูุงุณุชุฎุฑุฌ ุจูุงูุงุช ุงูููุชุฌ ุจุงูุชูุตูู. ุฃุนุฏ JSON ููุท ุจุงููุบุฉ ุงูุนุฑุจูุฉ.</textarea>
    </div>

    <!-- TEMPLATE STRUCTURE -->
    <div class="sec-label"><i class="fas fa-table"></i> ูููู ุงูุจูุงูุงุช ุงููุทููุจ</div>
    <div class="tpl-tabs">
      <button class="tpl-tab active" id="tab_json" onclick="switchTplMode('json')"><i class="fas fa-code"></i> JSON ูุจุงุดุฑ</button>
      <button class="tpl-tab" id="tab_csv" onclick="switchTplMode('csv')"><i class="fas fa-file-csv"></i> ูุงูุจ CSV</button>
    </div>
    <div id="tpl_json_wrap">
      <div class="field">
        <label>ูููู JSON ุงููุทููุจ</label>
        <textarea id="cfg_json" rows="8" onchange="saveConfig()" style="font-family:'JetBrains Mono',monospace;font-size:.72rem;">{
  "ุงูุงุณู": "ุงุณู ุงูููุชุฌ",
  "ุงูุฑูุฒ": "ููุฏ ุงูููุชุฌ",
  "ุงูุณุนุฑ": 0,
  "ุงููุตู_ุงููุฎุชุตุฑ": "ูุตู ูุตูุฑ",
  "ุงููุตู_ุงููุงูู": "ูุตู ุชูุตููู",
  "ุงูุนููุงู_ุงูุชุณูููู": "ุนููุงู SEO",
  "ุงููุตู_ุงูุชุณูููู": "ูุตู SEO"
}</textarea>
      </div>
    </div>
    <div id="tpl_csv_wrap" style="display:none;">
      <div class="field">
        <label>ุฑูุน ููู CSV ููุงูุจ</label>
        <div class="csv-drop" id="csvDrop" onclick="document.getElementById('csvFileInput').click()">
          <i class="fas fa-file-csv"></i>
          <span id="csvDropLabel">ุงููุฑ ุฃู ุงุณุญุจ ููู CSV ููุง</span>
          <input type="file" id="csvFileInput" accept=".csv,.tsv" style="display:none" onchange="handleCsvTemplate(event)">
        </div>
        <small>ูุฌุจ ุฃู ูุญุชูู ุนูู ุตู ุฑุฃุณ + ุตููู ูุซุงู. ุณููุณุชุฎุฏู ููุงูุจ ููู AI.</small>
      </div>
      <div id="csvColsWrap" style="display:none;">
        <div class="csv-cols" id="csvColTags"></div>
        <div class="csv-sample" id="csvSampleBox"></div>
      </div>
    </div>

    <!-- IMAGE SETTINGS -->
    <div class="sec-label"><i class="fas fa-image"></i> ุฅุนุฏุงุฏุงุช ุงูุตูุฑ</div>
    <div class="field">
      <label>ูุณุงุฑ ุงูุตูุฑ ุนูู ุงูุณูุฑูุฑ</label>
      <input type="text" id="cfg_path" value="catalog/products/" onchange="saveConfig()">
    </div>
    <div class="field">
      <label>ุชุณููุฉ ุงูุตูุฑ</label>
      <select id="cfg_naming" onchange="toggleNaming();saveConfig()">
        <option value="original">ุงูุงุณู ุงูุฃุตูู</option>
        <option value="pattern">ููุท ูุฎุตุต</option>
      </select>
    </div>
    <div class="field" id="namingPatternWrap" style="display:none;">
      <label>ุงูููุท (ุงุณุชุฎุฏู {i} ููุชุฑููู)</label>
      <input type="text" id="cfg_pattern" value="product_{i}" onchange="saveConfig()">
    </div>

    <!-- PROCESSING -->
    <div class="sec-label"><i class="fas fa-sliders-h"></i> ุงููุนุงูุฌุฉ</div>
    <div class="field">
      <label>ุนูููุงุช ูุชุฒุงููุฉ</label>
      <select id="cfg_concurrent" onchange="saveConfig()">
        <option value="1">1 ููู (ุขูู)</option>
        <option value="2">2 ูููุงุช</option>
        <option value="3" selected>3 ูููุงุช (ููุตู ุจู)</option>
        <option value="5">5 ูููุงุช (ุณุฑูุน)</option>
      </select>
    </div>
    <div class="field">
      <label>ูุญุงููุงุช ุฅุนุงุฏุฉ</label>
      <select id="cfg_retries" onchange="saveConfig()">
        <option value="0">ุจุฏูู ุฅุนุงุฏุฉ</option>
        <option value="1">ูุญุงููุฉ</option>
        <option value="2" selected>ูุญุงููุชุงู</option>
        <option value="3">3 ูุญุงููุงุช</option>
      </select>
    </div>
    <div class="field">
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
        <input type="checkbox" id="cfg_bgMode" onchange="saveConfig()" style="width:auto;accent-color:var(--glow);">
        ุงููุนุงูุฌุฉ ูู ุงูุฎูููุฉ
      </label>
    </div>

    <!-- EXPORT -->
    <div class="sec-label"><i class="fas fa-download"></i> ุชุณููุฉ ุงูุชุตุฏูุฑ</div>
    <div class="field">
      <input type="text" id="cfg_outRule" value="famelo_export_{date}" onchange="saveConfig()">
    </div>

  </div><!-- /sb-body -->

  <div class="sb-foot">
    <button class="btn btn-ghost" onclick="testConnection()" style="font-size:.78rem;">
      <i class="fas fa-plug"></i> ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
    </button>
  </div>
</aside>

<!-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
     MAIN AREA
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ -->
<main class="main">

  <!-- STATS HEADER -->
  <div class="stat-header">
    <div class="stat-top">
      <div class="stat-title">
        <i class="fas fa-microchip" style="color:var(--glow);"></i>
        <span id="statusTitle">ุฌุงูุฒ ูููุนุงูุฌุฉ</span>
      </div>
      <div class="provider-pill" id="provPill">
        <div class="pulse"></div>
        <span id="provPillText">โ ุงุฎุชุฑ ูุฒูุฏุงู โ</span>
      </div>
    </div>
    <div class="stats-grid">
      <div class="sbox s-info"><div class="slbl">ุงูุฅุฌูุงูู</div><div class="sval" id="stat_total">0</div></div>
      <div class="sbox s-ok"><div class="slbl">ููุชูู</div><div class="sval" id="stat_done">0</div></div>
      <div class="sbox s-warn"><div class="slbl">ููุฏ ุงูุชุดุบูู</div><div class="sval" id="stat_active">0</div></div>
      <div class="sbox s-err"><div class="slbl">ูุดู</div><div class="sval" id="stat_error">0</div></div>
    </div>
    <div class="pbar-track"><div class="pbar-fill" id="progressBar"></div></div>
    <div class="pbar-meta">
      <span id="progressPct">0%</span>
      <span id="progressLabel">ูู ุงูุชุธุงุฑ ุงูุจุฏุก...</span>
    </div>
    <div class="cur-task" id="curTask">
      <i class="fas fa-spinner fa-spin"></i>
      <span id="curTaskText">ุฌุงุฑู ุงููุนุงูุฌุฉ...</span>
    </div>
    <div class="ctrl-btns" id="ctrlBtns" style="display:none;">
      <button class="btn btn-warning btn-sm" id="btnPause" onclick="pauseProcessing()"><i class="fas fa-pause"></i> ุฅููุงู ูุคูุช</button>
      <button class="btn btn-danger btn-sm" id="btnStop" onclick="stopProcessing()"><i class="fas fa-stop"></i> ุฅููุงู ูุงูู</button>
    </div>
  </div>
    <!-- START BUTTON -->
  <button class="btn btn-primary" id="btnStart" onclick="startWorkflow()">
    <i class="fas fa-play"></i> ุจุฏุก ุงููุนุงูุฌุฉ
  </button>
  <!-- DROP ZONE -->
  <div class="drop-zone" id="dropZone"
    ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)"
    onclick="document.getElementById('fileInput').click()">
    <i class="fas fa-cloud-upload-alt dz-icon"></i>
    <div class="dz-title">ุงุณุญุจ ุงูุตูุฑ ููุง ุฃู ุงููุฑ ููุงุฎุชูุงุฑ</div>
    <div class="dz-sub">PNG ยท JPG ยท WEBP ยท ุญุชู 100 ุตูุฑุฉ</div>
    <input type="file" id="fileInput" multiple accept="image/*" style="display:none;" onchange="handleFileSelect(event)">
  </div>

  <!-- IMAGE GRID -->
  <div class="img-grid" id="imageGrid"></div>

  <!-- EXPORT PANEL -->
  <div class="export-panel" id="exportPanel">
    <div class="export-panel-head"><i class="fas fa-check-circle"></i> ุงูุชููุช ุงููุนุงูุฌุฉ โ ุชุตุฏูุฑ ุงููุชุงุฆุฌ</div>
    <div class="export-row">
      <div class="field"><label>ุงุณู ุงูููู</label><input type="text" id="final_name" value="famelo_export"></div>
      <div class="field">
        <label>ุงูุตูุบุฉ</label>
        <select id="final_type">
          <option value="xlsx">Excel (.xlsx)</option>
          <option value="csv">CSV (.csv)</option>
          <option value="json">JSON (.json)</option>
        </select>
      </div>
    </div>
    <button class="btn btn-success" onclick="generateAndDownload()" style="margin-top:12px;">
      <i class="fas fa-download"></i> ุชุญููู ุงูููู
    </button>
  </div>

  <!-- LOGS -->
  <div class="logs-panel">
    <div class="logs-head">
      <div class="logs-head-left"><i class="fas fa-terminal" style="color:var(--glow);"></i> ุณุฌู ุงูุนูููุงุช</div>
      <div class="logs-btns">
        <button class="log-btn" onclick="exportLogs()"><i class="fas fa-download"></i> ุชุตุฏูุฑ</button>
        <button class="log-btn" onclick="clearLogs()"><i class="fas fa-trash"></i> ูุณุญ</button>
      </div>
    </div>
    <div id="log-area"></div>
  </div>



</main>

<!-- DETAIL MODAL -->
<div class="modal" id="modal" onclick="if(event.target===this)this.style.display='none'">
  <div class="modal-box">
    <div class="modal-head">
      <h3><i class="fas fa-info-circle" style="color:var(--glow);"></i> ุชูุงุตูู ุงูููุชุฌ</h3>
      <button class="modal-close" onclick="document.getElementById('modal').style.display='none'"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<!-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
     JAVASCRIPT
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ -->
<script src="script.js" type="text/javascript" charset="utf-8"></script>
</body>
</html>
